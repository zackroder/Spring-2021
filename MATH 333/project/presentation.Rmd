---
title: "Analyzing the Effects of NAFTA on US Trade with Canada and Mexico"
author: "C.J. Laws, Zack Roder, Graham Shank"
date: "4/22/2021"
output: ioslides_presentation
---

```{r setup, include=FALSE}
library(astsa)
library(readxl)
library(priceR)

data <- read_excel("C:\\Users\\Zack\\Documents\\Spring 2021\\MATH 333\\project\\EXPORTS_IMPORTS_MEX_CAN.xls")

data$CAN_EXPORTS <- adjust_for_inflation(data$CAN_EXPORTS, data$observation_date, "US", to_date=2019)
data$CAN_IMPORTS <- adjust_for_inflation(data$CAN_IMPORTS, data$observation_date, "US", to_date=2019)

data$MEX_EXPORTS <- adjust_for_inflation(data$MEX_EXPORTS, data$observation_date, "US", to_date=2019)
data$MEX_IMPORTS <- adjust_for_inflation(data$MEX_IMPORTS, data$observation_date, "US", to_date=2019)

#use millions of dollars as unit
data$CAN_EXPORTS <- data$CAN_EXPORTS / 1000000 
data$CAN_IMPORTS <- data$CAN_IMPORTS / 1000000
data$MEX_EXPORTS <- data$MEX_EXPORTS / 1000000
data$MEX_IMPORTS <- data$MEX_IMPORTS / 1000000

#convert to ts object
CAN_EXPORTS <- ts(data$CAN_EXPORTS, start=1980, freq=12)
CAN_IMPORTS <- ts(data$CAN_IMPORTS, start=1980, freq=12)
MEX_EXPORTS <- ts(data$MEX_EXPORTS, start=1980, freq=12)
MEX_IMPORTS <- ts(data$MEX_IMPORTS, start=1980, freq=12)
```

## Introduction and Project Goals
- NAFTA, which established a free-trade zone on the North American Continent, went into effect in January 1994.
- To understand the effects of NAFTA on US trade with Canada and Mexico, we hope to develop a model to create a forecast with pre-NAFTA data.
- We could compare the forecasted trade numbers to the actual, post-NAFTA data to see if NAFTA significantly increased US trade with Mexico and Canada.
![](NAFTA_logo.svg){width=30%}

## Our Data
- To explore this question, we located data from FRED. We found 4 series that are useful in quantifying trade activity.
  + Exports: Value Goods for Canada (TEXVA01CAM667S)
  + Imports: Value Goods for Canada (TIMVA01CAM667S)
  + Exports: Value Goods for Mexico (TEXVA01MXM667S)
  + Imports: Value Goods for Mexico (TIMVA01MXM667S)
- The units for each series are US Dollars, Seasonally Adjusted. We retrieved data for 1980 through 2019.
- We first adjusted the series for inflation, such that the units are now 2019 US Dollars. This may, perhaps, help with some irregularities in the series. Even if it does not, it is helpful in interpreting the series over time.

## Our Data
Here is a preliminary plot of each of the four series:
```{r 1, echo = FALSE}
par(mfrow=c(2,2))
tsplot(CAN_EXPORTS, main="Monthly US Exports Canada, 1980-2019", ylab= "2019 US Dollars, Millions", xlab="Year")
tsplot(CAN_IMPORTS, main="Monthly US Imports from Canada, 1980-2019", ylab= "2019 US Dollars, Millions", xlab="Year")
tsplot(MEX_EXPORTS, main="Monthly US Exports to Mexico, 1980-2019", ylab= "2019 US Dollars, Millions", xlab="Year")
tsplot(MEX_IMPORTS, main="Monthly US Imports from Mexico, 1980-2019", ylab= "2019 US Dollars, Millions", xlab="Year")
```

## Our Data
To make one series, we sum together the four series. This combined series can now be interpreted as the monthly total trade with both Mexico and Canada. Also, since we are particularly interested in modeling the data between 1980 and 1994, we will splice it.
```{r 2, echo=FALSE, fig.width=6, fig.height=4, fig.align="center"}
TOTAL_TRADE = CAN_EXPORTS + CAN_IMPORTS + MEX_EXPORTS + MEX_IMPORTS
TOTAL_TRADE = ts(TOTAL_TRADE[1:168], start=1980, freq=12)
tsplot(TOTAL_TRADE, main="Monthly US Total Trade with Canada and Mexico, 1980-1994", ylab="2019 US Dollars, Millions", xlab="Year")
```

## Preliminary Analysis
Since the data is not stationary, we will need to coerce it. We can difference it:
```{r 3, echo=FALSE}
tsplot(diff(TOTAL_TRADE), main="First Difference Monthly US Total Trade with Canada and Mexico, 1980-1994", ylab="2019 US Dollars, Millions", xlab="Year")
```

## Preliminary Analysis
We also tried logging the series. The plot of the difference of the logged series follows:
```{r 4, echo=FALSE}
tsplot(diff(log(TOTAL_TRADE)), main="First Difference, Logged Monthly US Total Trade with Canada and Mexico, 1980-1994", ylab="Change in percent change, 2019 US Dollars", xlab="Year")
```

## Preliminary Analysis
Looking at the ACF/PACF plot for the differenced, logged series indicates an ARMA model is appropriate:
```{r 5, echo=FALSE}
acf2(diff(log(TOTAL_TRADE)), max.lag=160)
```

## Building Our Model
- We sought out to build an ARMA model that we could use to forecast total trade.
- First, we noticed that we want d=1 because that helped coerce the data into being stationary.
- Through trial and error, we settled on an ARIMA(2,1,0) model.

## Our Model
```{r 6, results='hide', fig.keep='all'}
sarima(log(TOTAL_TRADE), 2, 1, 0)
```

## Building a Forecast
Using our model, we can build a forecast using the 1980-1994 data and compare that to actual values.
```{r 7, echo=FALSE, results='hide', fig.width=7, fig.height=4, fig.align="center"}
sarima.for(log(TOTAL_TRADE), 60, 2, 1, 0)
TOTAL_TRADE_EXT = CAN_EXPORTS + CAN_IMPORTS + MEX_EXPORTS + MEX_IMPORTS
lines(log(TOTAL_TRADE_EXT))
```

## Forecast Evaluation
- The actual series values land on the outer edges of our confidence intervals, with most data points outside of the forecast's 80% confidence interval.

- This seems to suggest that NAFTA, in the 5 years following its implementation, did have a somewhat noticeable effect on US trade with Canada and Mexico. 

- This is even apparent in the original plot of the data. We can see an increase in the upward trend after 1994.

